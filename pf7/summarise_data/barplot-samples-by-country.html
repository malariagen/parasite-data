
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Barplot of Samples by Country &#8212; MalariaGEN parasite data user guide</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Summarise Genetic Variants" href="variant-summary-table.html" />
    <link rel="prev" title="Visualising sample collections over time" href="sample-collection-over-time.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MalariaGEN parasite data user guide</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../landing-page.html">
   MalariaGEN parasite data user guide
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pf7
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Data_access.html">
   Pf7 Data Access
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../useful-how-tos.html">
   <em>
    <em>
     Pf7 Analysis Guides
    </em>
    :
   </em>
   * Useful Genomics How-Tos
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../useful_how_tos/igv-notebook.html">
     Visualizing Genomic Regions of Pf7 Samples with IGV Plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../summarise-data.html">
   <em>
    <em>
     Pf7 Analysis Guides
    </em>
    :
   </em>
   * Summarise Pf7 Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="sample-summary-table.html">
     Summarise Samples by Administrative Division
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sample-collection-over-time.html">
     Visualising sample collections over time
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Barplot of Samples by Country
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="variant-summary-table.html">
     Summarise Genetic Variants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="global-sample-map.html">
     Plot Global Map of Samples
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evolution-malaria-control.html">
   *
   <em>
    Pf7 Analysis Guides
   </em>
   :**Study Evolution Against Malaria Control Measures
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../evolution_malaria_control/drug-resistance-summary.html">
     Drug Resistance Frequencies Across Pf7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evolution_malaria_control/chloroquine-resistance-map.html">
     Plot Map of Chloroquine Resistance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evolution_malaria_control/summarise_hrp2_hrp3_deletions.html">
     Summarise
     <em>
      hrp2
     </em>
     and
     <em>
      hrp3
     </em>
     Deletions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evolution_malaria_control/visualise_hrp2_hrp3_deletions.html">
     Visualise
     <em>
      hrp2
     </em>
     and
     <em>
      hrp3
     </em>
     Deletions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evolution_malaria_control/csp-cterm-analysis.html">
     Analyse csp C-Terminal Variation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../popgen.html">
   <em>
    <em>
     Pf7 Analysis Guides
    </em>
    :
   </em>
   * Population Structure and Selection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../popgen/PCoA.html">
     Principal Coordinate Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../popgen/geographic-genetic-differentiation.html">
     Geographic patterns of population differentiation and gene flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../popgen/neighbour-joining-tree-swga.html">
     Neighbour Joining Tree for sWGA vs. gDNA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../popgen/proportion-eba175.html">
     Plot
     <em>
      eba175
     </em>
     C Allele Proportions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api.html">
   Pf7 API
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pv4
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../pv4/Data_access.html">
   Pv4 Data Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pv4/api.html">
   Pv4 API
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/pf7/summarise_data/barplot-samples-by-country.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/malariagen/parasite-data"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/malariagen/parasite-data/issues/new?title=Issue%20on%20page%20%2Fpf7/summarise_data/barplot-samples-by-country.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/malariagen/parasite-data/master?urlpath=lab/tree/docs/pf7/summarise_data/barplot-samples-by-country.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/malariagen/parasite-data/blob/master/docs/pf7/summarise_data/barplot-samples-by-country.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#access-pf7-data">
   Access Pf7 Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-preparation-defining-populations">
   Figure preparation: Defining populations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-preparation-sort-countries-in-geographic-order">
   Figure preparation: Sort countries in geographic order
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-longitudes-to-locate-country">
     Using longitudes to locate country
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#splitting-countries-with-multi-populations">
   Splitting countries with multi-populations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-countries">
     Sorting countries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-the-figure">
   Make the figure
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-the-figure">
     Save the figure
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Barplot of Samples by Country</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#access-pf7-data">
   Access Pf7 Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-preparation-defining-populations">
   Figure preparation: Defining populations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-preparation-sort-countries-in-geographic-order">
   Figure preparation: Sort countries in geographic order
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-longitudes-to-locate-country">
     Using longitudes to locate country
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#splitting-countries-with-multi-populations">
   Splitting countries with multi-populations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-countries">
     Sorting countries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-the-figure">
   Make the figure
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-the-figure">
     Save the figure
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="barplot-of-samples-by-country">
<h1>Barplot of Samples by Country<a class="headerlink" href="#barplot-of-samples-by-country" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This notebook recreates <a class="reference external" href="https://figshare.com/ndownloader/files/38478530">Supplement Figure 1 from the Pf7 paper</a> - a bar plot which shows the number of samples in the Pf7 release, broken down by country. Each bar also details the number of samples passing QC (or not) per country.</p>
<p><strong>This notebook should take approximately 1 minute to run.</strong></p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Install and import the malariagen Python package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install -q --no-warn-conflicts malariagen_data
import malariagen_data
</pre></div>
</div>
</div>
</div>
<p>Import required python libraries that are installed at colab by default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="access-pf7-data">
<h2>Access Pf7 Data<a class="headerlink" href="#access-pf7-data" title="Permalink to this headline">¶</a></h2>
<p>We use the malariagen data package to load the release data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">release_data</span> <span class="o">=</span> <span class="n">malariagen_data</span><span class="o">.</span><span class="n">Pf7</span><span class="p">()</span>
<span class="n">sample_metadata</span> <span class="o">=</span> <span class="n">release_data</span><span class="o">.</span><span class="n">sample_metadata</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_metadata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c6637827-eff4-4bf7-85fe-fd031a6a9f8f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample</th>
      <th>Study</th>
      <th>Country</th>
      <th>Admin level 1</th>
      <th>Country latitude</th>
      <th>Country longitude</th>
      <th>Admin level 1 latitude</th>
      <th>Admin level 1 longitude</th>
      <th>Year</th>
      <th>ENA</th>
      <th>All samples same case</th>
      <th>Population</th>
      <th>% callable</th>
      <th>QC pass</th>
      <th>Exclusion reason</th>
      <th>Sample type</th>
      <th>Sample was in Pf6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FP0008-C</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR1081237</td>
      <td>FP0008-C</td>
      <td>AF-W</td>
      <td>82.16</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>gDNA</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FP0009-C</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR1081238</td>
      <td>FP0009-C</td>
      <td>AF-W</td>
      <td>88.85</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>gDNA</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FP0010-CW</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR2889621</td>
      <td>FP0010-CW</td>
      <td>AF-W</td>
      <td>86.46</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>sWGA</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c6637827-eff4-4bf7-85fe-fd031a6a9f8f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c6637827-eff4-4bf7-85fe-fd031a6a9f8f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c6637827-eff4-4bf7-85fe-fd031a6a9f8f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-521bbd70-2850-4738-ace6-2aa2c86fb7a4">
  <button class="colab-df-quickchart" onclick="quickchart('df-521bbd70-2850-4738-ace6-2aa2c86fb7a4')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-521bbd70-2850-4738-ace6-2aa2c86fb7a4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>We can start exploring the data by answering these questions:</p>
<ul class="simple">
<li><p>How many samples with QC pass</p></li>
<li><p>How many samples in each country</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the total number of samples</span>
<span class="n">total_sample_number</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># Calculate the number of samples that passed QC</span>
<span class="n">qc_pass_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;QC pass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calculate the number of samples that failed QC</span>
<span class="n">qc_fail_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;QC pass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We see </span><span class="si">{</span><span class="n">total_sample_number</span><span class="si">}</span><span class="s2"> samples of which </span><span class="si">{</span><span class="n">qc_pass_count</span><span class="si">}</span><span class="s2"> QC-pass and </span><span class="si">{</span><span class="n">qc_fail_count</span><span class="si">}</span><span class="s2"> QC fail in the overall Pf7 dataset.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We see 20864 samples of which 16203 QC-pass and 4661 QC fail in the overall Pf7 dataset.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the number of samples in each country</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ghana                               4090
Mali                                1804
Vietnam                             1733
Cambodia                            1723
Bangladesh                          1658
Myanmar                             1260
Gambia                              1247
Thailand                            1106
Laos                                1052
Kenya                                726
Tanzania                             697
Democratic Republic of the Congo     573
Malawi                               371
Benin                                334
India                                316
Cameroon                             294
Papua New Guinea                     251
Sudan                                203
Guinea                               199
Colombia                             159
Senegal                              155
Nigeria                              140
Indonesia                            133
Mauritania                           104
Mozambique                            91
Côte d&#39;Ivoire                         71
Gabon                                 59
Burkina Faso                          58
Ethiopia                              34
Madagascar                            25
Peru                                  21
Uganda                                15
Venezuela                              2
Name: Country, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="figure-preparation-defining-populations">
<h2>Figure preparation: Defining populations<a class="headerlink" href="#figure-preparation-defining-populations" title="Permalink to this headline">¶</a></h2>
<p>Countries are grouped into ten major sub-populations based on their geographic and genetic characteristics.</p>
<p>The dataframe has a <code class="docutils literal notranslate"><span class="pre">Population</span></code> column that contains abbreviated names, for clarity, we want to display the full name in the figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define populations in an ordered dictionary</span>
<span class="n">populations</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;SA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;South America&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AF-W&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;West Africa&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AF-C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Central Africa&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AF-NE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Northeast Africa&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AF-E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;East Africa&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AS-S-E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Eastern South Asia&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AS-S-FE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Far-eastern South Asia&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AS-SE-W&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Western Southeast Asia&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;AS-SE-E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Eastern Southeast Asia&#39;</span>
<span class="n">populations</span><span class="p">[</span><span class="s1">&#39;OC-NG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Oceania&#39;</span>

<span class="c1"># Map continent names into the df by using Population column and populations dictionary</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Population&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">populations</span><span class="p">)</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d5a2bbe2-9738-4d76-9f0b-f761cfe24103" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample</th>
      <th>Study</th>
      <th>Country</th>
      <th>Admin level 1</th>
      <th>Country latitude</th>
      <th>Country longitude</th>
      <th>Admin level 1 latitude</th>
      <th>Admin level 1 longitude</th>
      <th>Year</th>
      <th>ENA</th>
      <th>All samples same case</th>
      <th>Population</th>
      <th>% callable</th>
      <th>QC pass</th>
      <th>Exclusion reason</th>
      <th>Sample type</th>
      <th>Sample was in Pf6</th>
      <th>Continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FP0008-C</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR1081237</td>
      <td>FP0008-C</td>
      <td>AF-W</td>
      <td>82.16</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>gDNA</td>
      <td>True</td>
      <td>West Africa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FP0009-C</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR1081238</td>
      <td>FP0009-C</td>
      <td>AF-W</td>
      <td>88.85</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>gDNA</td>
      <td>True</td>
      <td>West Africa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FP0010-CW</td>
      <td>1147-PF-MR-CONWAY</td>
      <td>Mauritania</td>
      <td>Hodh el Gharbi</td>
      <td>20.265149</td>
      <td>-10.337093</td>
      <td>16.565426</td>
      <td>-9.832345</td>
      <td>2014.0</td>
      <td>ERR2889621</td>
      <td>FP0010-CW</td>
      <td>AF-W</td>
      <td>86.46</td>
      <td>True</td>
      <td>Analysis_set</td>
      <td>sWGA</td>
      <td>False</td>
      <td>West Africa</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d5a2bbe2-9738-4d76-9f0b-f761cfe24103')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d5a2bbe2-9738-4d76-9f0b-f761cfe24103 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d5a2bbe2-9738-4d76-9f0b-f761cfe24103');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0d7c0b39-123c-479e-9608-a17289d53436">
  <button class="colab-df-quickchart" onclick="quickchart('df-0d7c0b39-123c-479e-9608-a17289d53436')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0d7c0b39-123c-479e-9608-a17289d53436 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an ordered dictionary which maps the codes for major sub-populations -from west to east- to a colour code.</span>
<span class="n">population_colours</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;SA&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="s2">&quot;#4daf4a&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AF-W&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="s2">&quot;#e31a1c&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AF-C&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="s2">&quot;#fd8d3c&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AF-NE&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="s2">&quot;#bb8129&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AF-E&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="s2">&quot;#fecc5c&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AS-S-E&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s2">&quot;#dfc0eb&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AS-S-FE&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s2">&quot;#984ea3&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AS-SE-W&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#9ecae1&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;AS-SE-E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#3182bd&quot;</span>
<span class="n">population_colours</span><span class="p">[</span><span class="s1">&#39;OC-NG&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="s2">&quot;#f781bf&quot;</span>

<span class="c1"># Map population colours into the df by using Population column and population_colours dictionary</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;population_colour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Population&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">population_colours</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="figure-preparation-sort-countries-in-geographic-order">
<h2>Figure preparation: Sort countries in geographic order<a class="headerlink" href="#figure-preparation-sort-countries-in-geographic-order" title="Permalink to this headline">¶</a></h2>
<p>We want to sort the countries on the x-axis in geographic order, which means arranging them from left to right on the chart based on their geographical location, from west to east or by continents.</p>
<div class="section" id="using-longitudes-to-locate-country">
<h3>Using longitudes to locate country<a class="headerlink" href="#using-longitudes-to-locate-country" title="Permalink to this headline">¶</a></h3>
<p>To do this arrangement, we will use longitude coordinate countries which can be found in the dataset column <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">longitude</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the average of longitude of samples in each country</span>
<span class="n">mean_population_longitude</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)[</span><span class="s1">&#39;Country longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Add a new column that conveys mean population values for each sample</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Population_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Population&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mean_population_longitude</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="splitting-countries-with-multi-populations">
<h2>Splitting countries with multi-populations<a class="headerlink" href="#splitting-countries-with-multi-populations" title="Permalink to this headline">¶</a></h2>
<p>We identified three countries (Kenya, India, and Thailand) where the sampling locations are associated with more than one major sub-population”. For example, Kenya has sampling locations from AF-NE and AF-E, and this causes problems with ordering on country longitude because AF-NE and AF-E become mixed up in the table.</p>
<p>To accurately represent this diversity, we created a new column called <code class="docutils literal notranslate"><span class="pre">Country_or_admin1</span></code> and <code class="docutils literal notranslate"><span class="pre">Country_or_admin1_long</span></code> in our sample metadata.</p>
<p>These columns categorizes these countries based on their first-level administrative divisions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a duplicate column with country names</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span>
<span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country longitude&#39;</span><span class="p">]</span>

<span class="c1"># Rename each &#39;Admin level 1&#39; of split-countries</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kilifi&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Kenya, Kilifi&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kisumu&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Kenya, Kisumu&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Tripura&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;India, Tripura&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Odisha&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;India, Odisha or West Bengal&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;West Bengal&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;India, Odisha or West Bengal&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sisakhet&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Thailand, Sisakhet&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Tak&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Thailand, Tak or Ranong&#39;</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ranong&#39;</span><span class="p">),</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Thailand, Tak or Ranong&#39;</span>

<span class="c1"># Set longitude to that of admin1 for split countries</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Country_or_admin1_long&#39;</span>
<span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Admin level 1 longitude&#39;</span>
<span class="p">]</span>

<span class="c1"># Set longitude to that of admin1 with most samples for countries with more than one admin1 in population</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India, Odisha or West Bengal&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Country_or_admin1_long&#39;</span>
<span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India&#39;</span> <span class="p">)</span>
     <span class="o">&amp;</span> <span class="p">(</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Odisha&#39;</span> <span class="p">),</span>
    <span class="s1">&#39;Country_or_admin1_long&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand, Tak or Ranong&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Country_or_admin1_long&#39;</span>
<span class="p">]</span> <span class="o">=</span> <span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand&#39;</span> <span class="p">)</span>
     <span class="o">&amp;</span> <span class="p">(</span> <span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Admin level 1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Tak&#39;</span> <span class="p">),</span>
    <span class="s1">&#39;Country_or_admin1_long&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we want to arrange the divisions from the same countries adjacent to each other in order to facilitate meaningful comparisons when we look at the figure.</p>
<p>In order to do that we simply adjust their longitude values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust the longitude values to appear first or last</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kenya, Kisumu&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># Want it to appear last in AF-NE</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kenya, Kilifi&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">34</span> <span class="c1"># Want it to appear first in AF-E</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;India, Tripura&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span> <span class="c1"># Want it to appear first in AS-S-FE</span>
<span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Thailand, Sisakhet&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">103</span> <span class="c1"># Want it to appear first in AS-SE-E</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we don’t want Kenya returning travellers shown on plot, as we don’t know which admin division(s) they could have visited.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">,</span> <span class="s1">&#39;Population&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sorting-countries">
<h3>Sorting countries<a class="headerlink" href="#sorting-countries" title="Permalink to this headline">¶</a></h3>
<p>Now the countries are ready to sort geographically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_country_or_admin1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">sample_metadata</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Continent&#39;</span><span class="p">,</span> <span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="s1">&#39;population_colour&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">,</span> <span class="s1">&#39;Population_long&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Population_long&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">})</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_country_or_admin1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(36, 6)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-2e8f5bbf-d746-41e1-8484-316859cf09f3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Continent</th>
      <th>Population</th>
      <th>population_colour</th>
      <th>Population_long</th>
      <th>Country_or_admin1_long</th>
      <th>Frequency (number of samples)</th>
    </tr>
    <tr>
      <th>Country_or_admin1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Peru</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-74.356842</td>
      <td>21</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-73.086731</td>
      <td>159</td>
    </tr>
    <tr>
      <th>Venezuela</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-66.145936</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Gambia</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-15.372910</td>
      <td>1247</td>
    </tr>
    <tr>
      <th>Senegal</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-14.470363</td>
      <td>155</td>
    </tr>
    <tr>
      <th>Guinea</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-10.936960</td>
      <td>199</td>
    </tr>
    <tr>
      <th>Mauritania</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-10.337093</td>
      <td>104</td>
    </tr>
    <tr>
      <th>Côte d'Ivoire</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-5.554446</td>
      <td>71</td>
    </tr>
    <tr>
      <th>Mali</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-3.522152</td>
      <td>1804</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-1.745660</td>
      <td>58</td>
    </tr>
    <tr>
      <th>Ghana</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-1.210711</td>
      <td>4090</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>2.339713</td>
      <td>334</td>
    </tr>
    <tr>
      <th>Nigeria</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>8.097575</td>
      <td>140</td>
    </tr>
    <tr>
      <th>Gabon</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>11.784989</td>
      <td>59</td>
    </tr>
    <tr>
      <th>Cameroon</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>12.741504</td>
      <td>294</td>
    </tr>
    <tr>
      <th>Democratic Republic of the Congo</th>
      <td>Central Africa</td>
      <td>AF-C</td>
      <td>#fd8d3c</td>
      <td>23.660758</td>
      <td>23.660758</td>
      <td>573</td>
    </tr>
    <tr>
      <th>Sudan</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>30.005646</td>
      <td>203</td>
    </tr>
    <tr>
      <th>Uganda</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>32.391932</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Ethiopia</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>39.626195</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Kenya, Kisumu</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>40.000000</td>
      <td>64</td>
    </tr>
    <tr>
      <th>Kenya, Kilifi</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.000000</td>
      <td>662</td>
    </tr>
    <tr>
      <th>Malawi</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.300482</td>
      <td>371</td>
    </tr>
    <tr>
      <th>Tanzania</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.825685</td>
      <td>697</td>
    </tr>
    <tr>
      <th>Mozambique</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>35.551437</td>
      <td>91</td>
    </tr>
    <tr>
      <th>Madagascar</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>46.698618</td>
      <td>25</td>
    </tr>
    <tr>
      <th>India, Odisha or West Bengal</th>
      <td>Eastern South Asia</td>
      <td>AS-S-E</td>
      <td>#dfc0eb</td>
      <td>79.622525</td>
      <td>84.418059</td>
      <td>244</td>
    </tr>
    <tr>
      <th>India, Tripura</th>
      <td>Far-eastern South Asia</td>
      <td>AS-S-FE</td>
      <td>#984ea3</td>
      <td>89.833945</td>
      <td>90.000000</td>
      <td>72</td>
    </tr>
    <tr>
      <th>Bangladesh</th>
      <td>Far-eastern South Asia</td>
      <td>AS-S-FE</td>
      <td>#984ea3</td>
      <td>89.833945</td>
      <td>90.277384</td>
      <td>1658</td>
    </tr>
    <tr>
      <th>Myanmar</th>
      <td>Western Southeast Asia</td>
      <td>AS-SE-W</td>
      <td>#9ecae1</td>
      <td>98.496702</td>
      <td>96.510201</td>
      <td>1260</td>
    </tr>
    <tr>
      <th>Thailand, Tak or Ranong</th>
      <td>Western Southeast Asia</td>
      <td>AS-SE-W</td>
      <td>#9ecae1</td>
      <td>98.496702</td>
      <td>98.791050</td>
      <td>994</td>
    </tr>
    <tr>
      <th>Thailand, Sisakhet</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>103.000000</td>
      <td>112</td>
    </tr>
    <tr>
      <th>Laos</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>103.768157</td>
      <td>1052</td>
    </tr>
    <tr>
      <th>Cambodia</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>104.916873</td>
      <td>1723</td>
    </tr>
    <tr>
      <th>Vietnam</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>106.551796</td>
      <td>1733</td>
    </tr>
    <tr>
      <th>Indonesia</th>
      <td>Oceania</td>
      <td>OC-NG</td>
      <td>#f781bf</td>
      <td>135.577208</td>
      <td>117.314980</td>
      <td>133</td>
    </tr>
    <tr>
      <th>Papua New Guinea</th>
      <td>Oceania</td>
      <td>OC-NG</td>
      <td>#f781bf</td>
      <td>135.577208</td>
      <td>145.254007</td>
      <td>251</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2e8f5bbf-d746-41e1-8484-316859cf09f3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2e8f5bbf-d746-41e1-8484-316859cf09f3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2e8f5bbf-d746-41e1-8484-316859cf09f3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ef8a949e-1a04-4ae8-a258-c3106cf854f8">
  <button class="colab-df-quickchart" onclick="quickchart('df-ef8a949e-1a04-4ae8-a258-c3106cf854f8')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ef8a949e-1a04-4ae8-a258-c3106cf854f8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>We want to seperate and sort QC pass samples which will help to distinguish QC-fail samples in the figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_country_or_admin1_pass</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">sample_metadata</span>
        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample_metadata</span><span class="p">[</span><span class="s1">&#39;QC pass&#39;</span><span class="p">]]</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Continent&#39;</span><span class="p">,</span> <span class="s1">&#39;Population&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;population_colour&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Population_long&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Country_or_admin1&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Population_long&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_or_admin1_long&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">})</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_country_or_admin1_pass</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_country_or_admin1_pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(36, 6)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-0611038d-2816-4880-a936-7b922a1f0bcb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Continent</th>
      <th>Population</th>
      <th>population_colour</th>
      <th>Population_long</th>
      <th>Country_or_admin1_long</th>
      <th>Frequency (number of samples)</th>
    </tr>
    <tr>
      <th>Country_or_admin1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Peru</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-74.356842</td>
      <td>21</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-73.086731</td>
      <td>135</td>
    </tr>
    <tr>
      <th>Venezuela</th>
      <td>South America</td>
      <td>SA</td>
      <td>#4daf4a</td>
      <td>-73.157010</td>
      <td>-66.145936</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Gambia</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-15.372910</td>
      <td>863</td>
    </tr>
    <tr>
      <th>Senegal</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-14.470363</td>
      <td>150</td>
    </tr>
    <tr>
      <th>Guinea</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-10.936960</td>
      <td>151</td>
    </tr>
    <tr>
      <th>Mauritania</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-10.337093</td>
      <td>92</td>
    </tr>
    <tr>
      <th>Côte d'Ivoire</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-5.554446</td>
      <td>71</td>
    </tr>
    <tr>
      <th>Mali</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-3.522152</td>
      <td>1167</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-1.745660</td>
      <td>57</td>
    </tr>
    <tr>
      <th>Ghana</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>-1.210711</td>
      <td>3131</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>2.339713</td>
      <td>150</td>
    </tr>
    <tr>
      <th>Nigeria</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>8.097575</td>
      <td>110</td>
    </tr>
    <tr>
      <th>Gabon</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>11.784989</td>
      <td>55</td>
    </tr>
    <tr>
      <th>Cameroon</th>
      <td>West Africa</td>
      <td>AF-W</td>
      <td>#e31a1c</td>
      <td>-3.519507</td>
      <td>12.741504</td>
      <td>264</td>
    </tr>
    <tr>
      <th>Democratic Republic of the Congo</th>
      <td>Central Africa</td>
      <td>AF-C</td>
      <td>#fd8d3c</td>
      <td>23.660758</td>
      <td>23.660758</td>
      <td>520</td>
    </tr>
    <tr>
      <th>Sudan</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>30.005646</td>
      <td>76</td>
    </tr>
    <tr>
      <th>Uganda</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>32.391932</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Ethiopia</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>39.626195</td>
      <td>21</td>
    </tr>
    <tr>
      <th>Kenya, Kisumu</th>
      <td>Northeast Africa</td>
      <td>AF-NE</td>
      <td>#bb8129</td>
      <td>32.741894</td>
      <td>40.000000</td>
      <td>63</td>
    </tr>
    <tr>
      <th>Kenya, Kilifi</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.000000</td>
      <td>627</td>
    </tr>
    <tr>
      <th>Malawi</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.300482</td>
      <td>265</td>
    </tr>
    <tr>
      <th>Tanzania</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>34.825685</td>
      <td>589</td>
    </tr>
    <tr>
      <th>Mozambique</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>35.551437</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Madagascar</th>
      <td>East Africa</td>
      <td>AF-E</td>
      <td>#fecc5c</td>
      <td>35.999707</td>
      <td>46.698618</td>
      <td>24</td>
    </tr>
    <tr>
      <th>India, Odisha or West Bengal</th>
      <td>Eastern South Asia</td>
      <td>AS-S-E</td>
      <td>#dfc0eb</td>
      <td>79.622525</td>
      <td>84.418059</td>
      <td>233</td>
    </tr>
    <tr>
      <th>India, Tripura</th>
      <td>Far-eastern South Asia</td>
      <td>AS-S-FE</td>
      <td>#984ea3</td>
      <td>89.833945</td>
      <td>90.000000</td>
      <td>67</td>
    </tr>
    <tr>
      <th>Bangladesh</th>
      <td>Far-eastern South Asia</td>
      <td>AS-S-FE</td>
      <td>#984ea3</td>
      <td>89.833945</td>
      <td>90.277384</td>
      <td>1310</td>
    </tr>
    <tr>
      <th>Myanmar</th>
      <td>Western Southeast Asia</td>
      <td>AS-SE-W</td>
      <td>#9ecae1</td>
      <td>98.496702</td>
      <td>96.510201</td>
      <td>985</td>
    </tr>
    <tr>
      <th>Thailand, Tak or Ranong</th>
      <td>Western Southeast Asia</td>
      <td>AS-SE-W</td>
      <td>#9ecae1</td>
      <td>98.496702</td>
      <td>98.791050</td>
      <td>895</td>
    </tr>
    <tr>
      <th>Thailand, Sisakhet</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>103.000000</td>
      <td>59</td>
    </tr>
    <tr>
      <th>Laos</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>103.768157</td>
      <td>991</td>
    </tr>
    <tr>
      <th>Cambodia</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>104.916873</td>
      <td>1267</td>
    </tr>
    <tr>
      <th>Vietnam</th>
      <td>Eastern Southeast Asia</td>
      <td>AS-SE-E</td>
      <td>#3182bd</td>
      <td>105.173981</td>
      <td>106.551796</td>
      <td>1404</td>
    </tr>
    <tr>
      <th>Indonesia</th>
      <td>Oceania</td>
      <td>OC-NG</td>
      <td>#f781bf</td>
      <td>135.577208</td>
      <td>117.314980</td>
      <td>121</td>
    </tr>
    <tr>
      <th>Papua New Guinea</th>
      <td>Oceania</td>
      <td>OC-NG</td>
      <td>#f781bf</td>
      <td>135.577208</td>
      <td>145.254007</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0611038d-2816-4880-a936-7b922a1f0bcb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0611038d-2816-4880-a936-7b922a1f0bcb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0611038d-2816-4880-a936-7b922a1f0bcb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e31d7d0e-2ef3-4bcd-bb6e-ab98b4215865">
  <button class="colab-df-quickchart" onclick="quickchart('df-e31d7d0e-2ef3-4bcd-bb6e-ab98b4215865')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e31d7d0e-2ef3-4bcd-bb6e-ab98b4215865 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>Finally, we rename some countries with long names to shorter names to prevent the restriction of figure size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># rename the long-name countries in total samples df</span>
<span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Democratic Republic of the Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;DRC&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;India, Odisha or West Bengal&#39;</span><span class="p">:</span> <span class="s1">&#39;India, Odisha</span><span class="se">\n</span><span class="s1">or West Bengal&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Thailand, Tak or Ranong&#39;</span><span class="p">:</span> <span class="s1">&#39;Thailand, Tak</span><span class="se">\n</span><span class="s1">or Ranong&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># rename the long-name countries in QC-pass samples df</span>
<span class="n">df_country_or_admin1_pass</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Democratic Republic of the Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;DRC&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_country_or_admin1_pass</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;India, Odisha or West Bengal&#39;</span><span class="p">:</span> <span class="s1">&#39;India, Odisha</span><span class="se">\n</span><span class="s1">or West Bengal&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_country_or_admin1_pass</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Thailand, Tak or Ranong&#39;</span><span class="p">:</span> <span class="s1">&#39;Thailand, Tak</span><span class="se">\n</span><span class="s1">or Ranong&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="make-the-figure">
<h2>Make the figure<a class="headerlink" href="#make-the-figure" title="Permalink to this headline">¶</a></h2>
<p>We have the following considerations when making of this figure:</p>
<ol class="simple">
<li><p>While QC failed samples shown as outline only, others should have a solid-background to distinguish from each other</p></li>
<li><p>Lines and annotations at bottom for both continent and population.</p></li>
<li><p>The y-axis is truncated at 2,000 samples for visual clarity. With over 3,000 samples, Ghana is affected by this truncation. Therefore, specific annotations for QC pass and fail are positioned above Ghana’s bar to highlight its significance.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust the figure size</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">23.3</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Create the bars for all samples with a white backgound</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_country_or_admin1</span><span class="p">)),</span>
    <span class="n">df_country_or_admin1</span><span class="p">[</span><span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">],</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">df_country_or_admin1</span><span class="p">[</span><span class="s1">&#39;population_colour&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="c1"># Create the bars for QC pass with solid-colour background</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_country_or_admin1_pass</span><span class="p">)),</span>
    <span class="n">df_country_or_admin1_pass</span><span class="p">[</span><span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">],</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">df_country_or_admin1</span><span class="p">[</span><span class="s1">&#39;population_colour&#39;</span><span class="p">],</span>
    <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">df_country_or_admin1</span><span class="p">[</span><span class="s1">&#39;population_colour&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="c1"># Set x-axis labels and rotate them for readability</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_country_or_admin1</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="c1"># Set the y-axis limit to truncate bars at a maximum of 2000</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="c1"># Set axis labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Country or region&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis_transform</span><span class="p">()</span>
<span class="c1"># Add specific annotation to Ghana</span>
<span class="n">total_samples</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">pass_samples</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">x_pos</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<span class="c1"># Set the index number for Ghana</span>
<span class="n">x_pos</span><span class="p">[</span><span class="s1">&#39;Ghana&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">x_pos</span><span class="p">:</span>
    <span class="n">total_samples</span><span class="p">[</span><span class="n">country</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_country_or_admin1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">country</span><span class="p">,</span> <span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">]</span>
    <span class="n">pass_samples</span><span class="p">[</span><span class="n">country</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_country_or_admin1_pass</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">country</span><span class="p">,</span> <span class="s1">&#39;Frequency (number of samples)&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pass_samples</span><span class="p">[</span><span class="n">country</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_pos</span><span class="p">[</span><span class="n">country</span><span class="p">],</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">total_samples</span><span class="p">[</span><span class="n">country</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pass_samples</span><span class="p">[</span><span class="n">country</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_pos</span><span class="p">[</span><span class="n">country</span><span class="p">],</span> <span class="mf">1.05</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="n">y_offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span>
<span class="n">text_offset</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x_offset</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1"># Add annotations for Continents</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Continent&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;South</span><span class="se">\n</span><span class="s1">America&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Africa&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">3</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">24</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Asia&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">25</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">33</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Oceania&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">34.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">34</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">35</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y_offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.45</span>
<span class="n">text_offset</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x_offset</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="c1"># Add annotations for Populations</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;SA&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AF-W&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">3</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">14</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AF-C&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">15</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">15</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AF-NE&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">17.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">16</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">19</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AF-E&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">20</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">24</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AS-S-E&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">25</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">25</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AS-S-FE&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">26.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">26</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">27</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AS-SE-W&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">28.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">28</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">29</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;AS-SE-E&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">31.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">30</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">33</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;OC-NG&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">34.5</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">-</span><span class="n">text_offset</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">34</span><span class="o">-</span><span class="n">x_offset</span><span class="p">,</span> <span class="mi">35</span><span class="o">+</span><span class="n">x_offset</span><span class="p">],[</span><span class="n">y_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Customize tick label fonts and spacing</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/barplot-samples-by-country_40_0.png" src="../../_images/barplot-samples-by-country_40_0.png" />
</div>
</div>
<p><strong>Figure Legend. Breakdown of samples by country.</strong> Solid bars indicate samples which passed QC. Unfilled bars represent samples that failed QC. The y-axis is truncated at 2,000 samples, with the numbers of QC pass/QC fail samples in Ghana shown above the bar. Bars are coloured according to the major sub-population to which the location is assigned.</p>
<div class="section" id="save-the-figure">
<h3>Save the figure<a class="headerlink" href="#save-the-figure" title="Permalink to this headline">¶</a></h3>
<p>We can output this to a location in Google Drive</p>
<p>First we need to connect Google Drive by running the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You will need to authorise Google Colab access to Google Drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will send the file to your Google Drive, where you can download it from if needed</span>
<span class="c1"># Change the file path if you wish to send the file to a specific location</span>
<span class="c1"># Change the file name if you wish to call it something else</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/SamplesByCountry_Barplot_20210720.pdf&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/SamplesByCountry_Barplot_20210720.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span> <span class="c1"># increase the dpi for higher resolution</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pf7/summarise_data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="sample-collection-over-time.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Visualising sample collections over time</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="variant-summary-table.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Summarise Genetic Variants</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By MalariaGEN<br/>
    
        &copy; Copyright 2023.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>